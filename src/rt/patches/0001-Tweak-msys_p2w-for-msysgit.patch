From 85dd9f5a7d1914627cfc0c2902d16b204c9a200d Mon Sep 17 00:00:00 2001
From: Steffen Prohaska <prohaska@zib.de>
Date: Sun, 4 May 2008 14:02:45 +0200
Subject: [PATCH 01/19] Tweak msys_p2w for msysgit

---
 msys/rt/src/winsup/cygwin/path.cc | 8 ++++++--
 1 file changed, 6 insertions(+), 2 deletions(-)

diff --git a/msys/rt/src/winsup/cygwin/path.cc b/msys/rt/src/winsup/cygwin/path.cc
index 51a4fc1..1886914 100644
--- a/msys/rt/src/winsup/cygwin/path.cc
+++ b/msys/rt/src/winsup/cygwin/path.cc
@@ -3115,10 +3115,13 @@ msys_p2w (char const * const path)
       //
       // Prevent http://some.string/ from being modified.
       // 
-      if ((sspath > 0 && strlen (sspath) > 2)
+      if (((sspath > 0 && strlen (sspath) > 2)
 	  && (sspath[1] == '/')
 	  && (sspath[2] == '/')
 	  )
+	  // Prevent git's :/message syntax from beeing modified.
+	  || (strlen (spath) > 1 && spath[0] == ':' && spath[1] == '/')
+	  )
 	{
 	  debug_printf("returning: %s", path);
 	  return ((char *)path);
@@ -3134,7 +3137,8 @@ msys_p2w (char const * const path)
 	   // 
 	   // Prevent ``foo:echo /bar/baz'' from being considered a path list.
 	   // 
-	   && (strlen (sspath) > 1 && strchr (":./", sspath[1]) > 0)
+	   // Prevent :: from beeing considered a path list [msysgit].
+	   && (strlen (sspath) > 1 && strchr ("./", sspath[1]) > 0)
 	   )
     {
       //
-- 
1.9.4.msysgit.0

