From ca331e8952e6fd3f341e9e73b74fca6c291c41e2 Mon Sep 17 00:00:00 2001
From: Hiroshi Shirosaki <h.shirosaki@gmail.com>
Date: Wed, 9 Jul 2014 16:00:10 +0900
Subject: [PATCH 41/45] Add linker option to fix undefined reference

undefined reference to `_pei386_runtime_relocator'
---
 Makefile.in     | 2 +-
 gcc/Makefile.in | 4 ++--
 2 files changed, 3 insertions(+), 3 deletions(-)

diff --git a/Makefile.in b/Makefile.in
index 39f1e05..9067820 100644
--- a/Makefile.in
+++ b/Makefile.in
@@ -243,7 +243,7 @@ POSTSTAGE1_CXX_EXPORT = \
 	  -I$$r/prev-$(TARGET_SUBDIR)/libstdc++-v3/include \
 	  -I$$s/libstdc++-v3/libsupc++ \
 	  -L$$r/prev-$(TARGET_SUBDIR)/libstdc++-v3/src/.libs \
-	  -L$$r/prev-$(TARGET_SUBDIR)/libstdc++-v3/libsupc++/.libs"; \
+	  -L$$r/prev-$(TARGET_SUBDIR)/libstdc++-v3/libsupc++/.libs -Wl,--disable-runtime-pseudo-reloc"; \
 	  export CXX; \
 	CXX_FOR_BUILD="$$CXX"; export CXX_FOR_BUILD;
 @endif target-libstdc++-v3-bootstrap
diff --git a/gcc/Makefile.in b/gcc/Makefile.in
index 302c0e9..1fa0a36 100644
--- a/gcc/Makefile.in
+++ b/gcc/Makefile.in
@@ -132,8 +132,8 @@ LANGUAGES = c gcov$(exeext) gcov-dump$(exeext) $(CONFIG_LANGUAGES)
 T_CFLAGS =
 TCFLAGS =
 CFLAGS = @CFLAGS@
-CXXFLAGS = @CXXFLAGS@
-LDFLAGS = @LDFLAGS@
+CXXFLAGS = @CXXFLAGS@ -Wl,--disable-runtime-pseudo-reloc
+LDFLAGS = @LDFLAGS@ -Wl,--disable-runtime-pseudo-reloc
 
 # Flags to determine code coverage. When coverage is disabled, this will
 # contain the optimization flags, as you normally want code coverage
-- 
2.0.1

